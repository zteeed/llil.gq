/*
 * URL Shortener API
 *
 * This is a URL Shortener API
 *
 * API version: 1.0.0
 * Contact: aurelien@duboc.xyz
 * Generated by: Swagger Codegen (https://github.com/swagger-api/swagger-codegen.git)
 */
package swagger

import (
	"github.com/go-pg/pg/v10"
	"net/http"
	"strings"
)

type Route struct {
	Name    string
	Method  string
	Pattern string
	Handler http.Handler
}

type Routes []Route

func NewRouter(db *pg.DB, baseUrl string) *http.ServeMux {
	// router := mux.NewRouter().StrictSlash(true)
	router := http.NewServeMux()
	var routes = Routes{
		Route{
			"CreateNewShortURL",
			strings.ToUpper("Post"),
			"/api/v1/data/shorten",
			&CreateNewShortURL{db, baseUrl},
		},
		Route{
			"ReturnLongURL",
			strings.ToUpper("Get"),
			"/api/v1/{shortUrl}",
			&ReturnLongURL{db, baseUrl},
		},
	}
	for _, route := range routes {
		handler := Logger(route.Handler, route.Name)
		router.Handle(route.Pattern, handler)
	}

	return router
}
